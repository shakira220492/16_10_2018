{{ form_start(get_lyric_form_ajax, { 'attr' : {'novalidate': 'novalidate', 'role' : 'form', 'id': 'get-lyric-ajax'|default('form')} }) }}
{{ form_end(get_lyric_form_ajax) }}

{{ form_start(save_lyricsWord_form_ajax, { 'attr' : {'novalidate': 'novalidate', 'role' : 'form', 'id': 'save-lyricsWord-ajax'|default('form')} }) }}
{{ form_end(save_lyricsWord_form_ajax) }}

{{ form_start(delete_lyricsWord_form_ajax, { 'attr' : {'novalidate': 'novalidate', 'role' : 'form', 'id': 'delete-lyricsWord-ajax'|default('form')} }) }}
{{ form_end(delete_lyricsWord_form_ajax) }}

{{ form_start(get_lyrics_frame_form_ajax, { 'attr' : {'novalidate': 'novalidate', 'role' : 'form', 'id': 'get-lyrics-frame-ajax'|default('form')} }) }}
{{ form_end(get_lyrics_frame_form_ajax) }}

<div id="newEnvironment">
    
    <div id="currentVideoCronometroBackground">
    </div>
    
    <div id='videoFramesHeader'>
        <div id="currentVideoCronometro" class="animatedButton">
            0.0
        </div>
        <div id="wordHeaderButton">
            
            <input id='write_lyricsWord' class='animatedButton'
            type='text' placeholder='word' name='word'/>
            
            <input id='write_lyricsLine' class='animatedButton'
            type='text' placeholder='verse' name='word'/>
            
        </div>
    </div>
    
    <div id='videoFrames'>
        {#tiempo 1/4 de segundo cada div#}
        video frames
    </div>

    <div id='currentVideoLyrics'>
        {#previsualizacion de lyrics#}
        <div id='currentVideoLyricsContent'>
        </div>
        
        <div id='currentVideoLyricsBackGround'>
        </div>
    </div>
        
</div>

<script>
    
    function prepare_edit_video_lyrics()
    {
        var getInfoVideo = setInterval(function() {
            
            var my_video = document.getElementById("my_video");
            var videoDuration = my_video.duration;
            var videoDurationInteger = parseInt(videoDuration);

            if (videoDurationInteger)
            {
                {#alert("EXISTE "+videoDurationInteger);#}
                getLyric(videoDurationInteger); // me dibuja la letra de la canción al costado derecho
                drawFrames(videoDurationInteger); // me dibuja los frames que debe de tener la canción
                get_lyric_frame(); // me pinta los frames que contengan alguna letra de la canción
                clearInterval(getInfoVideo); // esta función me interrumpe el ciclo, es una función nativa de javascript
            } else
            {
                {#alert("NO EXISTE AÚN "+videoDurationInteger);#}
            }
        });
    }
    
    var position_lyrics = 0;
    
    function getLyric(videoDurationInteger)
    {
{#        alert("get lyrics");#}
        var form = $('#get-lyric-ajax');
        var url = form.attr('action');

        $.post(url, {current_video_id: current_video_id}, function (data)
        {
            var variable = data[0].variable;

            var amountLyricsLine = data[0][0].amountLyricsLine;
            
            position_lyrics = 0;
            document.getElementById("currentVideoLyricsContent").innerHTML = "";
            for (d=0; d<amountLyricsLine; d++)
            {

            
                var lyricslineId = data[d][0].lyricslineId;
                drawNewLine_lyrics(lyricslineId);
                
                var amountWord = data[d][0].amountWord;

                estrofaAmount_EditLyrics = amountLyricsLine; 
                palabraAmount_EditLyrics = amountWord; 
            
{#                alert("estrofaAmount_EditLyrics... "+estrofaAmount_EditLyrics+
                      "palabraAmount_EditLyrics... "+palabraAmount_EditLyrics);#}
                for (e=0; e<=amountWord; e++)
                {
                    var keywordId = data[d][e].keywordId;
                    var keywordContent = data[d][e].keywordContent;
                    var lyricslineId = data[d][e].lyricslineId;
                    var lyricswordId = data[d][e].lyricswordId;
                    var lyricswordStarttime = data[d][e].lyricswordStarttime;
                    var lyricswordEndtime = data[d][e].lyricswordEndtime;
                    var amountKeywords = data[d][e].amountKeywords;
                    var palabra = data[d][e].palabra;
                    var estrofa = data[d][e].estrofa;
                    var amountWord = data[d][e].amountWord;
                    var amountLyricsLine = data[d][e].amountLyricsLine;
                    var currentWordPosition = data[d][e].currentWordPosition;
                    
                    lyricsWord_EditLyrics[d][e][0] = keywordId;
                    lyricsWord_EditLyrics[d][e][1] = keywordContent;
                    lyricsWord_EditLyrics[d][e][2] = lyricslineId;
                    lyricsWord_EditLyrics[d][e][3] = lyricswordId;
                    lyricsWord_EditLyrics[d][e][4] = lyricswordStarttime;
                    lyricsWord_EditLyrics[d][e][5] = lyricswordEndtime;
                    lyricsWord_EditLyrics[d][e][6] = amountKeywords;
                    lyricsWord_EditLyrics[d][e][7] = palabra;
                    lyricsWord_EditLyrics[d][e][8] = estrofa;
                    lyricsWord_EditLyrics[d][e][9] = amountWord;
                    lyricsWord_EditLyrics[d][e][10] = amountLyricsLine;
                    lyricsWord_EditLyrics[d][e][11] = currentWordPosition;
                    
                    appendWordToLine_lyrics(
                            keywordId,
                            keywordContent,
                            lyricslineId,
                            lyricswordId,
                            lyricswordStarttime,
                            lyricswordEndtime,
                            amountKeywords,
                            palabra,
                            estrofa,
                            amountWord,
                            amountLyricsLine,
                            currentWordPosition
                        );
                
                }
            }
        }).fail(function () {
            alert('ERROR get-lyric-ajax');
        });
    }
        
    function drawNewLine_lyrics(lyricslineId)
    {
        position_lyrics += 25;
        $("#currentVideoLyricsContent").append(
            "<div id='currentVideo_lyricsLine"+lyricslineId+"' class='lyricsLine_lyrics' style='top: "+position_lyrics+"px;'>"+
            " "+
            "</div>"
        );
    }
    
    function appendWordToLine_lyrics(
                keywordId,
                keywordContent,
                lyricslineId,
                lyricswordId,
                lyricswordStarttime,
                lyricswordEndtime,
                amountKeywords,
                palabra,
                estrofa,
                amountWord,
                amountLyricsLine,
                currentWordPosition
            )
    {
        $("#currentVideo_lyricsLine"+lyricslineId).append(
            "<div id='currentVideo_lyricsWord"+keywordId+"' class='lyricsWord_lyrics'>"+
            "&nbsp"+keywordContent+"&nbsp"+
            "</div>"
        );
    }
    
    
    function drawFrames(videoDurationInteger)
    {
        var videoFrames = document.getElementById("videoFrames");
        videoFrames.innerHTML = "";
        var j=0;
        
        for(i=0; i<videoDurationInteger; i+=0.1)
        {
{#            alert("i: "+i+" cdhjcd: "+cdhjcd);#}
            
            $("#videoFrames").append(
                "<div id='frame"+j+"' class='video_frame' {#draw_status='available'#} data-id3='"+i+"' data-id4='"+j+"'>"+
                    "<div id='start_time"+j+"' class='start_time' data-id3='"+i+"' data-id4='"+j+"'>"+
                    i.toFixed(1)+
                    "</div>"+
                    "<div id='word_lyrics"+j+"' class='word_lyrics' draw_status='available' start_id='"+j+"' start_time='"+i+"' data-id3='"+i+"' data-id4='"+j+"'>"+
                    
                    "<div id='menu_lyricsWord_frame"+j+"' class='menu_lyricsWord_frame'>"+

                        "<div id='leyend_lyricsWord_frame"+j+"' class='leyend_lyricsWord_frame' data-id3='"+i+"' data-id4='"+j+"'>"+
                        ""+
                        "</div>"+
                        
                        "<input id='write_lyricsWord_frame"+j+"' class='write_lyricsWord_frame'  data-id3='"+i+"' data-id4='"+j+"' "+
                        "type='text' placeholder='Word' name='keyword' readonly='readonly'/>"+

                        "<input id='write_lyricsLine_frame"+j+"' class='write_lyricsLine_frame'  data-id3='"+i+"' data-id4='"+j+"' "+
                        "type='text' placeholder='1' name='keyword' readonly='readonly'/>"+

                        "<div id='save_lyricsWord_frame"+j+"' class='save_lyricsWord_frame' data-id3='"+i+"' data-id4='"+j+"'>"+
                        "[]"+
                        "</div>"+
                        
                        "<div id='edit_lyricsWord_frame"+j+"' class='edit_lyricsWord_frame' data-id3='"+i+"' data-id4='"+j+"'>"+
                        "[]"+
                        "</div>"+

                        "<div id='replay_lyricsWord_frame"+j+"' class='replay_lyricsWord_frame' data-id3='"+i+"' data-id4='"+j+"'>"+
                        "[]"+
                        "</div>"+

                        "<div id='delete_lyricsWord_frame"+j+"' class='delete_lyricsWord_frame' data-id3='"+i+"' data-id4='"+j+"'>"+
                        "[]"+
                        "</div>"+
                        
                    "</div>"+
                        
                        
                    "<div id='delete_only_frame"+j+"' class='delete_only_frame animatedButton' data-id3='"+i+"' data-id4='"+j+"'>"+
                    "-"+
                    "</div>"+
                    "<div id='add_only_frame"+j+"' class='add_only_frame animatedButton' data-id3='"+i+"' data-id4='"+j+"'>"+
                    "+"+
                    "</div>"+
                    
                    "</div>"+
                "</div>"
            );
    
    
            $('#delete_only_frame'+j)
            .click(function () {
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                ///////////////////////////////////////////////////////////////
                
                var previousId = id - 1;
                var nextId = id + 1;
                
                var previousFrameId = "frame"+previousId;
                var previousFrame = document.getElementById(previousFrameId);
                var previousWord_lyricsId = "word_lyrics"+previousId;
                var previousWord_lyrics = document.getElementById(previousWord_lyricsId);
                var previousWord_lyrics_drawStatus = previousWord_lyrics.getAttribute("draw_status");
                var previousWord_lyrics_startId = parseInt(previousWord_lyrics.getAttribute("start_id"));
                var previousWord_lyrics_endId = parseInt(previousWord_lyrics.getAttribute("end_id"));
                var previousWord_lyrics_startTime = parseFloat(previousWord_lyrics.getAttribute("start_time"));
                var previousWord_lyrics_endTime = parseFloat(previousWord_lyrics.getAttribute("end_time"));
                
                var thisFrameId = "frame"+id;
                var thisFrame = document.getElementById(thisFrameId);
                var thisWrite_lyricsWord_frameId = "write_lyricsWord_frame"+id;
                var thisWrite_lyricsWord_frame = document.getElementById(thisWrite_lyricsWord_frameId);
                var thisWord_lyricsId = "word_lyrics"+id;
                var thisWord_lyrics = document.getElementById(thisWord_lyricsId);
                var thisWord_lyrics_drawStatus = thisWord_lyrics.getAttribute("draw_status");
                var thisWord_lyrics_startId = parseInt(thisWord_lyrics.getAttribute("start_id"));
                var thisWord_lyrics_endId = parseInt(thisWord_lyrics.getAttribute("end_id"));
                var thisWord_lyrics_startTime = parseFloat(thisWord_lyrics.getAttribute("start_time"));
                var thisWord_lyrics_endTime = parseFloat(thisWord_lyrics.getAttribute("end_time"));
        
                var nextFrameId = "frame"+nextId;
                var nextFrame = document.getElementById(nextFrameId);
                var nextWord_lyricsId = "word_lyrics"+nextId;
                var nextWord_lyrics = document.getElementById(nextWord_lyricsId);
                var nextWord_lyrics_drawStatus = nextWord_lyrics.getAttribute("draw_status");
                var nextWord_lyrics_startId = parseInt(nextWord_lyrics.getAttribute("start_id"));
                var nextWord_lyrics_endId = parseInt(nextWord_lyrics.getAttribute("end_id"));
                var nextWord_lyrics_startTime = parseFloat(nextWord_lyrics.getAttribute("start_time"));
                var nextWord_lyrics_endTime = parseFloat(nextWord_lyrics.getAttribute("end_time"));
                
                firstFrameId = thisWord_lyrics_startId;
                firstFrameTime = thisWord_lyrics_startTime;
                lastFrameId = thisWord_lyrics_endId;
                lastFrameTime = thisWord_lyrics_endTime;
                currentWord = thisWrite_lyricsWord_frame.placeholder;
                
                if (previousWord_lyrics_drawStatus === "unavailable" && 
                    previousWord_lyrics_startId === thisWord_lyrics_startId) // incrementar valor superior
                {
                    var previousWord_lyrics_endId = thisWord_lyrics_endId - 1;
                    var previousWord_lyrics_endTime = thisWord_lyrics_endTime - 0.1;
                    
                    lastFrameId = previousWord_lyrics_endId;
                    lastFrameTime = previousWord_lyrics_endTime;
                }
                
                if (nextWord_lyrics_drawStatus === "unavailable" &&
                    nextWord_lyrics_startId === thisWord_lyrics_startId) // incrementar valor inferior
                {
                    var nextWord_lyrics_endId = thisWord_lyrics_startId + 1;
                    var nextWord_lyrics_endTime = thisWord_lyrics_startTime + 0.1;
                    
                    firstFrameId = nextWord_lyrics_endId;
                    firstFrameTime = nextWord_lyrics_endTime;
                }
                
                delete_word_frames(id, time);
                draw_word();
                save_lyricsWord_crud(id);
            });
            
            $('#add_only_frame'+j)
            .click(function () {
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                ///////////////////////////////////////////////////////////////
                
                var previousId = id - 1;
                var nextId = id + 1;
                
                var previousFrameId = "frame"+previousId;
                var previousFrame = document.getElementById(previousFrameId);
                var previousWord_lyricsId = "word_lyrics"+previousId;
                var previousWord_lyrics = document.getElementById(previousWord_lyricsId);
                var previousWord_lyrics_drawStatus = previousWord_lyrics.getAttribute("draw_status");
                
                var thisFrameId = "frame"+id;
                var thisFrame = document.getElementById(thisFrameId);
                var thisWrite_lyricsWord_frameId = "write_lyricsWord_frame"+id;
                var thisWrite_lyricsWord_frame = document.getElementById(thisWrite_lyricsWord_frameId);
                var thisWord_lyricsId = "word_lyrics"+id;
                var thisWord_lyrics = document.getElementById(thisWord_lyricsId);
                var thisWord_lyrics_drawStatus = thisWord_lyrics.getAttribute("draw_status");
                var thisWord_lyrics_startId = parseInt(thisWord_lyrics.getAttribute("start_id"));
                var thisWord_lyrics_endId = parseInt(thisWord_lyrics.getAttribute("end_id"));
                var thisWord_lyrics_startTime = parseFloat(thisWord_lyrics.getAttribute("start_time"));
                var thisWord_lyrics_endTime = parseFloat(thisWord_lyrics.getAttribute("end_time"));
        
                var nextFrameId = "frame"+nextId;
                var nextFrame = document.getElementById(nextFrameId);
                var nextWord_lyricsId = "word_lyrics"+nextId;
                var nextWord_lyrics = document.getElementById(nextWord_lyricsId);
                var nextWord_lyrics_drawStatus = nextWord_lyrics.getAttribute("draw_status");
                
                firstFrameId = thisWord_lyrics_startId;
                firstFrameTime = thisWord_lyrics_startTime;
                lastFrameId = thisWord_lyrics_endId;
                lastFrameTime = thisWord_lyrics_endTime;
                currentWord = thisWrite_lyricsWord_frame.placeholder;
                
                if (previousWord_lyrics_drawStatus === "available") // incrementar valor superior
                {
                    var previousWord_lyrics_startId = thisWord_lyrics_startId - 1;
                    var previousWord_lyrics_startTime = thisWord_lyrics_startTime - 0.1;
                    
                    var previousWord_lyrics_endId = thisWord_lyrics_endId;
                    var previousWord_lyrics_endTime = thisWord_lyrics_endTime;
                    
                    firstFrameId = previousWord_lyrics_startId;
                    firstFrameTime = previousWord_lyrics_startTime;
                }
                
                if (nextWord_lyrics_drawStatus === "available") // incrementar valor inferior
                {
                    var nextWord_lyrics_endId = thisWord_lyrics_endId + 1;
                    var nextWord_lyrics_endTime = thisWord_lyrics_endTime + 0.1;
                    
                    var nextWord_lyrics_startId = thisWord_lyrics_startId;
                    var nextWord_lyrics_startTime = thisWord_lyrics_startTime;
                    
                    lastFrameId = nextWord_lyrics_endId;
                    lastFrameTime = nextWord_lyrics_endTime;
                }
                delete_word_frames(id, time);
                
                draw_word();
                save_lyricsWord_crud(id);
            });
            
            $('#save_lyricsWord_frame'+j)
            .mouseover(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "block";
                document.getElementById("leyend_lyricsWord_frame"+id).innerHTML = "save";
                
            })
            .mouseout(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "none";
                
            })
            .click(function () {
                var id = $(this).data('id4');
                
                var thisWordId = "word_lyrics"+id;
                var word_lyrics = document.getElementById(thisWordId);
                var startId = parseInt(word_lyrics.getAttribute("start_id"));
                var endId = parseInt(word_lyrics.getAttribute("end_id"));
                var startTime = parseFloat(word_lyrics.getAttribute("start_time")).toFixed(1);
                var endTime = parseFloat(word_lyrics.getAttribute("end_time")).toFixed(1);
            });
    
            $('#edit_lyricsWord_frame'+j)
            .mouseover(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "block";
                document.getElementById("leyend_lyricsWord_frame"+id).innerHTML = "edit";
                
            })
            .mouseout(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "none";
                
            })
            .click(function () { // cuando el mouse se mueve sobre el div
                edit_lyricsWord(); //GUI
            });
    
            $('#replay_lyricsWord_frame'+j)
            .mouseover(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "block";
                document.getElementById("leyend_lyricsWord_frame"+id).innerHTML = "replay";
                
            })
            .mouseout(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "none";
                
            })
            .click(function () { // cuando el mouse se mueve sobre el div
                replay_lyricsWord(); //GUI
            });
    
            $('#delete_lyricsWord_frame'+j)
            .mouseover(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "block";
                document.getElementById("leyend_lyricsWord_frame"+id).innerHTML = "delete";
                
            })
            .mouseout(function () {
                var id = $(this).data('id4');
                
                document.getElementById("leyend_lyricsWord_frame"+id).style.display = "none";
                
            })
            .click(function () { // cuando el mouse se mueve sobre el div
                var time = $(this).data('id3');
                var id = $(this).data('id4');
        
                delete_word_frames(id, time); //GUI
                delete_lyricsWord_crud();// CRUD
                
                alert("delete_lyricsWord");
            });
            
            $('#word_lyrics'+j)
            .mousemove(function () { // cuando el mouse se mueve sobre el div
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                var write_lyricsWord = document.getElementById("write_lyricsWord");
                currentWord = write_lyricsWord.value;
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    mouse_status = 0;
                    draw_word();
                    {#save_lyricsWord_crud(id);#} // depronto sobrecarga la pagina web 
                    displace_video(time);
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    lastFrameTime = time;
                    lastFrameId = id;
                    draw_frame();
                    displace_video(time);
                }
                
                document.getElementById("write_lyricsWord").style.backgroundColor = "#1ab7ea";
                
            })
            .mouseup(function () { // cuando el boton del mouse se deja de oprimir
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                var write_lyricsWord = document.getElementById("write_lyricsWord");
                currentWord = write_lyricsWord.value;
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    lastFrameTime = time;
                    lastFrameId = id;
                    draw_word();
                    save_lyricsWord_crud(id);
                }
                
                mouse_status = 0;
            })
            .mousedown(function () { // cuando el boton del mouse se encuentra oprimido
                
                var write_lyricsWord = document.getElementById("write_lyricsWord").value;
                var write_lyricsLine = document.getElementById("write_lyricsLine").value;
                
                if (!write_lyricsWord || !write_lyricsLine)
                {
                    // inputs desocupados
                    
                } else
                {
                    // inputs ocupados
                    
                    mouse_status = 1;
                    var time = $(this).data('id3');
                    var id = $(this).data('id4');

                    var thisFrame = "frame"+id;
                    var thisWordId = "word_lyrics"+id;
                    var thisTimeId = "start_time"+id;

                    var frame = document.getElementById(thisFrame);
                    var word_lyrics = document.getElementById(thisWordId);
                    var start_time = document.getElementById(thisTimeId);

                    var write_lyricsWord = document.getElementById("write_lyricsWord");
                    currentWord = write_lyricsWord.value;

                    if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                    {
                        mouse_status = 0;
                        {#displace_video(time);#}
                    } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                    {
                        lastFrameId = id;
                        firstFrameId = id;

                        lastFrameTime = time;
                        firstFrameTime = time;

                        draw_frame();
                        displace_video(time);
                    }
                    
                }
        

                
            })
            .mouseover(function () { // cuando el cursor se encuentra por encima del frame
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                var write_lyricsWord = document.getElementById("write_lyricsWord");
                currentWord = write_lyricsWord.value;
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    
                } 
                
        
                if (word_lyrics.getAttribute('draw_status') === "unavailable") {
                    start_time.style.opacity = "1";
                } else if (word_lyrics.getAttribute('draw_status') === "available") {
                    word_lyrics.style.opacity = "1";
                    start_time.style.opacity = "1";
                }
            })
            .mouseout(function () { // cuando el cursor se sale del frame
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                var write_lyricsWord = document.getElementById("write_lyricsWord");
                currentWord = write_lyricsWord.value;
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    previousFrameId = id;
                    previousFrameTime = time;
                } 
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable") {
                    start_time.style.opacity = "0.4";
                } else if (word_lyrics.getAttribute('draw_status') === "available") {
                    word_lyrics.style.opacity = "0.4";
                    start_time.style.opacity = "0.4";
                }
                
                document.getElementById("write_lyricsWord").style.backgroundColor = "white";
                
            });
            
            $('#start_time'+j)
            .mouseup(function () {
                var time = $(this).data('id3');
                displace_video(time);
            })
            .mousemove(function () {
                var time = $(this).data('id3');
        
                if (moveAutomaticallyVideo === 0)
                {
                    document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
                }
                else if (moveAutomaticallyVideo === 1)
                {
                    displace_video(time);
                }
            })
            .mousedown(function () {
                var time = $(this).data('id3');
        
                if (moveAutomaticallyVideo === 0)
                {
                    document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
                }
                else if (moveAutomaticallyVideo === 1)
                {
                    displace_video(time);
                }
            })
            .mouseover(function () {
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    
                }
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable") {
                    start_time.style.opacity = "1";
                } else if (word_lyrics.getAttribute('draw_status') === "available") {
                    word_lyrics.style.opacity = "1";
                    start_time.style.opacity = "1";
                }
                
                if (moveAutomaticallyVideo === 1)
                {
                    document.getElementById("currentVideoCronometroBackground").style.opacity = "0.5";
                } else if (moveAutomaticallyVideo === 0)
                {
                    document.getElementById("currentVideoCronometroBackground").style.opacity = "0";
                }
                
            })
            .mouseout(function () {
                var time = $(this).data('id3');
                var id = $(this).data('id4');
                
                var thisFrame = "frame"+id;
                var thisWordId = "word_lyrics"+id;
                var thisTimeId = "start_time"+id;
                
                var frame = document.getElementById(thisFrame);
                var word_lyrics = document.getElementById(thisWordId);
                var start_time = document.getElementById(thisTimeId);
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable" && mouse_status === 1)
                {
                    
                } else if (word_lyrics.getAttribute('draw_status') === "available" && mouse_status === 1)
                {
                    previousFrameId = id;
                    previousFrameTime = time;
                } 
                
                if (word_lyrics.getAttribute('draw_status') === "unavailable") {
                    start_time.style.opacity = "0.4";
                } else if (word_lyrics.getAttribute('draw_status') === "available") {
                    word_lyrics.style.opacity = "0.4";
                    start_time.style.opacity = "0.4";
                }
                
                document.getElementById("currentVideoCronometroBackground").style.opacity = "0";
                
                if (moveAutomaticallyVideo === 0)
                {
                    // poner en gris
                    document.getElementById("currentVideoCronometro").style.backgroundColor = "gray";
                }
                
            });
            
            j++;
        }
    }
    
    function save_lyricsWord_crud(id)
    {
        var word_lyricsId = "word_lyrics"+id;
        var word_lyrics = document.getElementById(word_lyricsId);
        var startTime = parseFloat(word_lyrics.getAttribute("start_time"));
        var endTime = parseFloat(word_lyrics.getAttribute("end_time"));
        
        // to next events: $('#add_only_frame'+j), $('#delete_only_frame'+j), 
        var thisWrite_lyricsWord_frameId = "write_lyricsWord_frame"+id;
        var thisWrite_lyricsWord_frame = document.getElementById(thisWrite_lyricsWord_frameId);
        var lyricsWord = thisWrite_lyricsWord_frame.placeholder;
        var thisWrite_lyricsLine_frameId = "write_lyricsLine_frame"+id;
        var thisWrite_lyricsLine_frame = document.getElementById(thisWrite_lyricsLine_frameId);
        var lyricsLine = thisWrite_lyricsLine_frame.placeholder;
        
        // to next events: $('#word_lyrics'+j).mouseUp 
        var write_lyricsWord_frame = document.getElementById("write_lyricsWord");
        var word = write_lyricsWord_frame.value;
        
        
        
        
        
        
        
        
        
        
        
        
{#    parameters:
    -id to get (lyrics_line, start_time, end_time, (word: input from menu(content)... or input from frames(placeholder))), )#}
                
        
{#        var write_lyricsWordId = "write_lyricsWord_frame"+id;
        var write_lyricsWord = document.getElementById(write_lyricsWordId).placeholder;

        if (write_lyricsWord)
        {
            save_lyricsWord_crud(id);// CRUD
        } else
        {
            alert("debes escribir una palabra para adicionar al karaoke... "+write_lyricsWord);
        }#}
        
        
        
        {#alert("se genero el crud.... "+write_lyricsWord+" "+startTime+" "+endTime);#}
        var form = $('#save-lyricsWord-ajax');
        var url = form.attr('action');



        $.post(url, {write_lyricsWord: write_lyricsWord,
            current_video_id: current_video_id,
            startTime: startTime,
            endTime: endTime
        }, function (data)
        {
            var write_lyricsWord_value = data[0].write_lyricsWord;
            var current_video_id_value = data[0].current_video_id;
            var startTime_value = data[0].startTime;
            var endTime_value = data[0].endTime;
            
{#            alert("se genero el crud... "+write_lyricsWord_value+
                    " "+current_video_id_value+
                    " "+startTime_value+
                    " "+endTime_value);#}
                            
        }).fail(function () {
            alert('ERROR save-lyricsWord-ajax');
        });
    }
    
    function delete_lyricsWord_crud()
    {
        var form = $('#delete-lyricsWord-ajax');
        var url = form.attr('action');

        $.post(url, function (data)
        {
            {#alert("delete-lyricsWord-ajax");#}
            var variable = data[0].variable;
                    
            {#'variable' => "funciona"#}
                    
        }).fail(function () {
            alert('ERROR delete-lyricsWord-ajax');
        });
    }

    function showCurrentTime_withoutFormat()
    {
        var v = document.getElementById("my_video");
        
        speed_millisecond = video_speedButton * 1000;
        var videoDuration_2 = v.duration;
        
        var currentVideoCronometro = document.getElementById("currentVideoCronometro");
        
        currentVideo_playing = setInterval(function() {
            currentVideoCronometro.innerHTML = v.currentTime.toFixed(1);

            v.onended = function() {
                clearInterval(currentVideo_playing);
            };
            
            
        }, 100);
    }
</script>

<script>
    $('#currentVideoCronometro')
    .click(function () {
        
        if (moveAutomaticallyVideo === 0)
        {
            moveAutomaticallyVideo = 1;
            document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
            document.getElementById("currentVideoCronometroBackground").style.opacity = "0.6";
        }
        else if (moveAutomaticallyVideo === 1)
        {
            moveAutomaticallyVideo = 0;
            document.getElementById("currentVideoCronometro").style.backgroundColor = "gray";
            document.getElementById("currentVideoCronometroBackground").style.opacity = "0.1";
        }
        
    })
    .mouseover(function () { 
        
        if (moveAutomaticallyVideo === 0)
        {
            document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
        }
        else if (moveAutomaticallyVideo === 1)
        {
            document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
            document.getElementById("currentVideoCronometroBackground").style.opacity = "0.6";
        }
        
    })
    .mouseout(function () { 
        
        
        if (moveAutomaticallyVideo === 0)
        {
            document.getElementById("currentVideoCronometro").style.backgroundColor = "gray";
            document.getElementById("currentVideoCronometroBackground").style.opacity = "0";
        }
        else if (moveAutomaticallyVideo === 1)
        {
            document.getElementById("currentVideoCronometro").style.backgroundColor = "#1ab7ea";
            document.getElementById("currentVideoCronometroBackground").style.opacity = "0";
        }

    });
    
    function get_lyric_frame()
    {
        var form = $('#get-lyrics-frame-ajax');
        var url = form.attr('action');

        $.post(url, {current_video_id: current_video_id}, function (data)
        {
            alert("get-lyrics-frame-ajax");

            var amountLyricsWord = data[0].amountLyricsWord;
            
            for (i = 0; i < amountLyricsWord; i++)
            {
                var keywordContent = data[i].keywordContent;
                var lyricslinePosition = data[i].lyricslinePosition;
                var lyricswordId = data[i].lyricswordId;
                var lyricswordStarttime = data[i].lyricswordStarttime;
                var lyricswordEndtime = data[i].lyricswordEndtime;
                
                firstFrameId = lyricswordStarttime * 10;
                lastFrameId = lyricswordEndtime * 10;
                firstFrameTime = lyricswordStarttime;
                lastFrameTime = lyricswordEndtime;
                currentWord = keywordContent;
                lyricsLine = lyricslinePosition;
                
                draw_word();
            }
                
        }).fail(function () {
            alert('ERROR... get-lyrics-frame-ajax');
        });
    }
</script>